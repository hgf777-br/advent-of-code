from copy import deepcopy
from time import time

data = """#.###.##..#....
.#.###.....####
...##...###.##.
...######..#..#
##.#..#.##..##.
.#.##..#....##.
##..##.#...####
.####..##.#####
#.####.#....##.
..#.###.#..#..#
##...####...##.
##...####...##.
..#.###.#..#..#
#.###..#....##.
.####..##.#####

##..#.#......#..#
.....#..#.#######
...########...##.
..#.#.#.###...##.
..#.#..#.#.#.#..#
..##...#.##.#.##.
###.####..##.#...
....#..#.#..#.##.
....#.###..##....
..##.#..##.######
...##..#.#.##....
...#.#..#........
###....##..######
..#...##..##.#..#
..#.......#...##.

#####.###
.#.###..#
##...##.#
....###.#
....###.#
##...##.#
.#.###..#
#####.###
..##.#.##
###...##.
.##.#.###
.##.#.#.#
###...##.

..###...#####
#######..#..#
########.#..#
..###...#####
##.###..#####
#.....###.##.
#..###..##..#
.#.#.##...##.
.#.##########
..###.###.##.
####..#.#....
##.##.....##.
###...##.....
...#.#.##....
.##..#.#.#..#

#......#...
.#.#.##....
##..####.##
...##....##
..#...##...
#..#.......
##..#.#..##
###..#.####
###..#.#.##

..#......#...
###.####.####
.#..#..#.##..
.#..#..#..#..
##..####..###
##..####..###
.....##......
.###.##.###..
##..####..###
#.########.##
.##......##..
.#..#..#..#..
#...####...##

#....##.#..#.##
.#..#.##.####.#
.#..#.##.####.#
#....##.#..####
#.##.#..#.####.
......#..#....#
.#..#...#..##.#
.#..#.###.##.##
..##...##...#.#
......#.####.#.
#.##.#..#......
..##...###.#.#.
......#..##.#.#

..##.######
##.....#..#
..#.###.##.
#.###..####
.##.#..#..#
.##....#..#
#.###..####

...#.####.#
##.#..##..#
##.........
..##..##..#
##..#....#.
##....##...
..#........
##..#.##.#.
...#......#
...#.###..#
...########
####..##..#
..#.##..##.
###..####..
..#.######.

##.....###...
##.....###...
##.##.####.##
###..###.##..
........#..#.
#.#..#.#..##.
##.##.###..#.

...##.####.#.#.
..####.#...#...
.....##.#.#..##
##.....###.#.#.
######.###.#...
##.##....#.####
...#.####..####
..###....##.##.
..###..#...#..#
..###..##..#..#
..###....##.##.
...#.####..####
##.##....#.####
######.###.#...
##.....###.#.#.

##.#####.####..
..#.##..#.##.#.
..#.########...
###.###.###....
...#####.##.#..
##.#..#..#...#.
...##....#..#..
##..##...##.##.
##..##..####.#.
##....#.#.##..#
###...#.#.##..#
##..##..####.#.
##..##...##.##.

...#.##.##.##.#..
#....#..##..#....
.#..#.##..##.#..#
.#..#.##..##.#..#
#....#..##..#....
...#.##.##.##.#..
####.##....##.###
.#.##........##.#
######.#..#.#####
#.##...#..#...#..
.#.#....##....#.#
....#.#.##.#.#...
##..###.##.###..#
#.#.#.#....#.#.#.
.######....######

..#..###.
..#.#.###
..#...###
.##....##
....#.#.#
####.##..
####.##..
....#.#.#
.##....##
..#...###
..#.#.###

....##.##
#.##.....
###....#.
###....#.
#.##.....
....##.##
#.#..####
#.#.....#
.##.#.#.#
##...#.#.
##...#.#.
.#..#.#.#
#.#.....#
#.#..####
....##.##
#.##.....
###....#.

###.#........
#.#.#.#.##.#.
##.##.#.##.#.
..##.#.#..#.#
.##...#....#.
.#...##.##.##
.#...##.##.##
.##...#....#.
..##.#.#..#.#
##.##.#.##.#.
#.#...#.##.#.
###.#........
#.....#.##.#.

#.##..###..####
.##...#..###..#
.##...#..#.#..#
.#.######..##.#
#....##.###.###
.###..#.##.##..
...#.#.##..#...
#.........###.#
###.#.....##..#
###.#.....##..#
#.........###.#
...#.#.##..#...
.###..#.##.##..
#....##.###.###
.#.######..##.#
.##...#..#.#..#
.##...#..###..#

.....######....
..#.#..##..#.#.
##.#........#.#
###....##....##
##.....##.....#
..############.
..#...#..#.....

##...##
#..###.
#...#.#
#...#.#
#..###.
##...##
###.##.
#.#..##
..##..#
.#..#..
#.##..#
#....#.
#....#.
#.#...#
.#..#..

#..##.###..
.##....#.#.
......##.#.
#..#.###.##
######.....
######.....
#..#.######

...##..##.#..###.
..#.#..#.#....##.
####.##.####....#
.##.#..#.##..#..#
.#.#....#.#...###
##..####..###..#.
##..####..###..#.
.#.#....#.#...###
.##.#..#.##..#..#
####.##.####....#
..#.#..#.#....##.

####.#...
...#.####
##...##..
###.#....
..#.#.#..
###....##
####.####
..##.#..#
##.###..#
.#.#..#.#
###.###..
###.#.###
######.#.
..#.#.###
####....#
####....#
..#.#.###

#..##..##..##..##
##.#....####....#
##.######..######
...######..######
#..#.##.#..#.##.#
#####.########.##
###..##..##..##..

###....####
####...##.#
##.##.##..#
####..##..#
##.##.#.##.
##.###.####
####.######
####.#..##.
.....#.#..#

..##.#...
..##.##..
..#..##.#
##.######
..#.#..#.
##.#.#.##
...##..#.

....###..###...
.....##..##....
..##..#..#..##.
...###....###..
##.##########.#
##.........#..#
####.#....#.###
..#.###..###.#.
##....#..#....#

.....#.#.####.#
#....##.#..#..#
##..##.#.....#.
#....####......
..##..##..#....
.####.#####.##.
##..##.##.##.##
##..##.#.....#.
######.##.###.#
..##..#.##..#.#
..##..#.##..#.#
######.##.###.#
##..##.#.....#.

.#####...#.
.#..####..#
#####.##.##
#.#.##.###.
.###..####.
#.##.......
..##.##....
..##.##....
#.##.......
.###..####.
#.#.##.###.
.####.##.##
.#..####..#
.#####...#.
##.....####
.#.#..###..
.#.#..###..

#.#.##.....
#..#####..#
..#..#.....
..#..#.....
#..#####..#
#.#.##.....
#......####
##.#.#..##.
.#.####...#
..###.#....
..#...#####
....####..#
#.#.####..#
#..####....
#.#.#.#####
#..#.#.....
...#.######

##..##........#
..##..#..#.#.#.
..##..#..#.#.#.
##..##........#
.####.#.#.#....
..##.....##..##
#....######.#..
.####....##.#..
.####.#.#...#.#
######.###.#..#
.........##....
.####.#..###..#
########..#....
.####......#..#
........#####.#
#...###.....#.#
......#.....##.

#..##...##.
###..####.#
####...####
.##.#..#..#
....##....#
####..#...#
####..#...#
....##....#
.##.#..#..#

.######.#..
#..##..#.##
##.##.##...
.######....
..#..#.....
#########..
.##..##....
##.....#.##
..####.....
#########..
#.####.#.##
.######....
.##..##.###
#......#...
##....##.##
#......#.##
...##...#..

#....###.#.#..#
#....###.###..#
..#..####..####
.###..##.##.##.
...###.##.#....
....###....####
..#..#.#...#..#
.#.####..#..##.
#..#.###..#####
###.#.###..####
..######..##..#

###.##.####
##.####.###
####..#####
##......##.
.#.####.#..
..#.##.#...
..#.##.#..#
...####....
##.#..#.###

.##########
....#...#.#
....#...###
.##########
......###.#
#..#.###.#.
#..#.###.#.

#######..##
##..##.####
##..###.###
.#..#.###..
..##.......
....#.##.##
..##...##..
.#..#.#.#..
..##..##.##
.####.###..
#....######
......#.#..
######.#...

..#..#.##..##
###.#...#..#.
..####.######
...#...#.##.#
#..#.#.......
#.#..##..##..
#.###........
#.#.#........
#.#..##..##..

...####..#..#.#
###....#..#..##
.#....#.#.#.###
.#.....#.......
#.##...##.#..##
####..#......##
#...#.#.#.#.#..
#.##.#####..#..
.....####.#####
.....####.#####
#.##.#####..#..

........##...
########...#.
##########...
#########.#..
#########.#..
#..##..#.#.##
.##..##..####
########..#.#
##.##.##.#.#.

..#...###.####.#.
..#...###.####.#.
#.#......#..#...#
#..#...#######...
##.##...#####.#.#
######...###..##.
#######..###..##.

##..#...###
..###.#.##.
##.#.#.#.#.
..#.##.#...
####.####..
####.#.#...
...#..##.##
...#..#.#..
..####..###
...#.####.#
...######.#

.##..##....##..
.##..##....##.#
##########...#.
#.#..#.##..#.#.
##....##.####.#
#.####.#..#....
#.#..#.#.#..#..

####.....#.##.#
..##...#....###
..##...#....###
####.....#.##.#
#...#..##.#..##
#..##.....#...#
#.##....##.##.#
#.##.##..##..#.
.#....##.#.#.##
##.#.#####...#.
##.#.#####..##.

....#..##
.##...###
....#....
.##.##.#.
.##...#.#
.##...#.#
.##.##.#.
....#....
.##...###
....#..##
.###...#.
#..#.....
.....#..#
#..#.####
........#
######...
####.....

.#....#.#.#..
#.####.###.##
.#####..#..##
########.##..
##.##.##.....
#..##..#...##
#########.#..
##.##.###..##
.#.##.#......

#..###..###
......##...
.....#..#..
##..#....#.
....##..##.
##.#.#..#.#
..####..###
##.##.##.##
..##.####.#
..##.####.#
....#.##.#.
....#....#.
..#........
###........
##.#.####.#

#....#...#...#.##
.#..#...##..#....
.####.##..#..##..
..###.....##..#..
.####..#..##.####
..##..###.#.#.###
##..##.#.###.####
######...#.##....
#######.....##.##
#....##..#.#.....
.#..#.#...#...#..

#.####...##
##..##..#.#
.####......
..##..#....
.#..#..#.##
.####.#....
#....###.#.
##..###.#..
#.##.##.###
.#..#.##..#
.......#...
.####.#..#.
##..###....
##..###....
.####.#..#.

.##...#..##
..##.#.##..
#.#..#..###
.#####.#.##
..#..###...
###..#...##
####.##....
..#..###...
...#.##....
....#....##
.....#..#..
####..#.#..
###.#.#.#..
#..##......
#..#.#..#..
.#.#..#..##
.#.#.##..##

####..#...#..#.
####.....##..##
#..#.....##..##
#..#.##.#..##..
#####..###.##.#
...#...........
.##..#...######
#..#.#.#...##..
#..##.....#..#.
.....#...##..##
#..####...#..#.
.##...#.##....#
.##.####..#..#.
.....####......
.....##...#..#.
####.....##..##
####..#.##....#

...#...##...#
##.##.####.##
##.##..##..##
#######..####
#######..####
##.##..##..##
##.##.####.##
...#...##...#
#......##....
.##.#......#.
#..##.#..#.##
.#.#.######.#
##.#...##.#.#

.#.###.#.
.######.#
##.#...##
#.##....#
####.####
#.##....#
#.##....#
#.##.####
#.##....#
##.#...##
.######.#
.#.###.#.
.#..#...#
.###.#.#.
.###.#.#.

.....##
......#
#.#...#
.#.##.#
.#.##.#
#.#...#
......#
.....##
.####..

.#####.......#..#
#.#.#.#....#....#
...#...#.##....##
######...##.#.#..
#.#..####...##.##
####....##....##.
####....##...###.
#.#..####...##.##
######...##.#.#..
...#...#.##....##
#.#.#.#....#....#
.#####.......#..#
.#.##...#.###...#
..####.###..####.
..#.#..#.##.#....
..#.#..#.##.#....
..####.###..####.

.#..#.#.#.#.#
.#..#.#.#....
..##..#..#.##
##..####...##
##..####...##
..##..#.##.##
.#..#.#.#....
.#..#.#.#.#.#
#.##.##...#.#
..##...##...#
......##.#.#.
######.......
##..#######..
#.##.###.....
######....##.

.###..####.##..#.
..#....##..##.#.#
..#.#.....##.#.#.
..###.##..#..####
.#.#.#.#.#..###.#
......#########.#
.....##########.#
###..##..######..
##.###.......###.
##.###.......###.
###..##..######..
.....##########.#
......#########.#

#.##...
##.####
..##...
...#...
##.##..
.#...##
##...##
.##.#..
..###..
.#.####
#..#...
#####..
.##....
.##....
###.#..

#....##..##..##
#.##.#..####..#
##..###.#..#.##
.........##....
.#..#.##.##.##.
#.##.####..####
..##....#.##...
.#..#..##..##..
#.##.##.#..#.##

###.##....##.
##...........
##.##......##
...##.#..#.##
..####....###
..####....###
...##.#..#.##
##.##......##
##...........
###.##....##.
.####.#..#.##
##.#.#.##.#.#
..##.#....#.#
#...#..##..#.
..#.#..##..#.
##.....##....
.###.######..

#....#.######.#..
##..##.###.##.##.
.#..#.#.####.#.#.
######.#....#.###
######.#....#.###
######.#....#.###
.####.#......#.##

.#.#.##....##.#
...#..##..##..#
..###........##
.#...#.####.#..
..##.##.##.##.#
###...##..##...
..###.##..##.#.
##..##..##..##.
###...#.##.#...
.#..##..##..##.
...###......###
##.###.#..#.###
.####........##
.####........##
##.###.#..#.###

#.##.####.##.
....##..##...
..#.#....#.#.
.###......###
.###......###
..#.#....#.#.
....##..##...
#.##.####.##.
.#.#..#...#.#
...###..###..
....######...

#........##.#
####.#.#.##..
####.#.#..#..
#........##.#
.#.##.#..#.#.
.#.##.#..#.#.
#........##.#
####.#.#..#..
####.#.#.##..
#........##.#
.....##..###.
##...##.###..
..#....##.#.#
....##.#..###
.##....#.#.#.
.########.#.#
#.#####..####

....#.#..#.
....#.#..#.
.#.###..#..
..###......
##...##...#
####.#.###.
..##.......
..##.......
####.#.###.
##...##...#
..###......
.#.###..#.#
....#.#..#.

...##.###.##.
#....#..##.##
.#.#..#..##..
.##....#..##.
###....#..##.
##..#.#.##.##
.#..#..#..#..
.#..#..#..#..
##..#.#.##.##
###....#..##.
.##....#..##.

#.#...#..#...#.
#.#...#..#...#.
...#....#..#..#
###..#.#.####.#
..#.#.##.###...
....###.##.####
#.####...#.##.#
.##.#...##..#.#
.##.##......#.#
.###.#.#....###
..#......###.##
.#.##...#....##
.#..#..#.#.##.#
.#..##.#.#.##.#
.#.##...#....##
..#......###.##
.###.#.#....###

#.####.##..
#..##..####
#......####
#.####.##.#
#.####.#.#.
#.####.###.
..#..#..###
#.#..#.##.#
.#....#.###
.##..##.##.
..#..#....#
.#..#.#.#.#
###..###...
###..#####.
###..#####.

#.##.#.#...
.####..##..
.#..#..####
##..###.###
#....###...
#.##.#...##
.#..#......
.####...###
########.##
#....#..###
.#..#...#..
##..#.#####
##..###.###

............###
#.########.##..
#.#..##..#.#.##
...######...#..
.##########.#..
#.#..##....#...
.##......##....
..#.####.#.....
#..#.##.#..#.##
#..##..##..#.##
.#.######.#.#..

#..##..#.####
#########.##.
#..####.#####
#..##...#####
#######......
.##.##....##.
#..#..##.....
.##......#...
#..#..#...##.
#########.##.
#..####..####
########..##.
.##...##.####

...##..####
...##..###.
##.#.#####.
...#.#..###
##...##....
..#.....##.
..#.##.#.##

.##..#.
####...
...##.#
.##.#..
####..#
.##.#..
....###
....###
.##.#..

#.#.....##..##.
.###.##..#..#.#
##.#...#..#.###
.....#........#
##..#.##...#.##
....#..#####..#
##..#.#..#.###.
##..#.#..#.###.
#...#..#####..#
##..#.##...#.##
.....#........#
##.#...#..#.###
.###.##..#..#.#
#.#.....##..##.
#.#.....##..##.

####...###...#..#
.##.##.#....##..#
.##....##.#.#..##
....##.......##.#
.##.##...#.#.##..
####..###.#.#.#..
#..###.##........
.##..##.#..###...
#..##.#.#..##....
.#...#.#.#.#.####
....#....#.#...##
#..####..###..#.#
#..##...###.##...
.##....#.#.#..###
####.###.#...#...
####.###.#...#...
.##....#.#.#..###

.#...####.#######
.#.#.#..#........
..#.#...#..##..##
..###.#.#.###..##
###......##.####.
#.####..#...####.
...#####...#...##
#...#..#.#.##..##
##.....#.#..####.
##.....#.#..####.
#...#..#.#.##..##

..#....#.
..#.###..
##...####
.....#...
..#...###
..#.##.#.
..#.##.#.
..#...###
.....#...
##...##.#
..#.###..
..#....#.
##.....##
..#...##.
####.....
..#.##.##
...#...#.

#....#...####
#.##.#.#.####
######...##..
##..####..#..
##..###..##..
.#..#..#.#...
......###..#.
.#..#.#######
#######.##.##
######..##.##
##..###.###..
.####.##..#..
.......##..##

.#....##....#
.#....##....#
#...#.##.#...
#....####..#.
..#.######.#.
#..#.#..#.#..
###.#.##.#.##

#....##
.####.#
.####..
#....##
#.##.#.
#....##
#.##.##

..#####.#.###..##
##.#.#..##...#.#.
#..#..#########.#
#..#..#########.#
##.#.#..##...#.#.
..#####.#.###..##
..#.#.###.#.#...#
..#.#...#.#......
.#####......#.##.
.#..#.###.##..###
.####..##...#..#.
.####..##...#..#.
.#..#.#.#.##..###

#####...#
#.##..##.
...#.#..#
..##.#.#.
..####.#.
...#.#..#
#.##..##.
#####...#
.......#.
##..###.#
..#.#.#..
#...#...#
###..##.#
.#..##..#
.#..##..#

###....#####.##.#
###....#####.##.#
.########..#.####
...#..#....#.#..#
#.#.##.#.###.####
.#.####.#.#.##...
#.#....#.#..##...
...#..#..#.#.....
##..##..#####.###
.###..###.#...#..
..######...##....
.###..###....#..#
....##.....#####.
#........###.#..#
#...##...##.#####

###.##.
##.#..#
##.#..#
###.##.
.##....
.##..#.
#..####

######.
###.#..
..###.#
..###.#
###.#..
######.
#.#.#..
..###.#
......#
####..#
##.####
##.####
####..#
......#
..#.#.#
#.#.#..
######.

...##.......#.#..
..#..#.#...#..##.
...##.......#.##.
............#.#.#
###########.###..
#.#..#.##..#...#.
..#..#.......##..
..####...###.....
..####...###.....
..#..#.......##..
#.#..#.##..#...#.

.####...#..##
#.##..####.##
.#####.#.##..
##..###...###
.##.##.######
#..#####...##
##.#..#.#.##.
#..#...#...##
.##..#..#.###
#.##....#.###
...#####.#...
#.###.....#..
#.###.....#..
...#####.#...
#.##....#.###

.#.##.#..
#..##..##
..#..#.##
##.##.###
.#.##.#..
.######..
##.##.###

..##..##..#
.###.#..#..
....#....##
....#....##
.###....#..
..##..##..#
#.##..#.#..
#.##..#.#..
..##..##..#
.###....#..
....#....##

##.#..#
..#....
...#..#
##..##.
...####
....##.
...#.##

#.##.#...
######.##
..##.....
.####..##
.####..#.
.#..#....
..##..###
#....##..
......###
#.##.##..
#....#...

..#.#......#.#...
###..##..##..####
.#.##########.#..
.#...######.#.#..
.####.#..#.####..
##.###....###.###
#..##########..##
.###.#....#.###..
...#.#....#.#....
###....##....####
.#...##..##...#..
###.##.##.##.####
##.###.##.###.###
####...##...#####
####..#..#..#####
##.#..#..#..#.###
....##.##.##.....

#..########..##
..#.#....#.#...
#..#..##..#..##
##.#.####.#.###
....##..##.....
##.####.###.###
#.###....###.##
..#.##..##.#...
...##....##....
.##.#....#.##..
##....##....###
..#.######.#...
##..######..###

....#..#.
###.####.
...######
.#.#.##.#
#.###..##
..#######
#.#######
#.#......
.#.#....#
#..#.#..#
.####..##
#.#..##..
#.#..##..

..####..##..####.
...##.#.##.#.##..
..#...##..##...#.
##.##..#####.##.#
....##.#..#.##...
..#.##.#..#.##.#.
##.####....####.#
...##.######.##..
##.##..#..#..##.#
###.#.######.#.##
##.#.###..###.#.#
....#........#...
..###.#....#.###.

#.##.#......#..#.
......###.##...##
#....#....##....#
#.##.#...####..##
..##..#.#.#......
..##...###...##..
.#..#..###.......

####.##.#..##.#
..#...##..#####
.##..#.......#.
.##..#.......#.
..#...##..#####
####.##.#..##.#
####...#..#....
....###.###.###
..###.#.#.##.##
.####.#.######.
.####.#.###.##.
..###.#.#.##.##
....###.###.###
####...#..#....
####.##.#..##.#

#####...##..#..
...#.#.#.#.##.#
.#.####..#.####
#...##.#.#..##.
....##.#.#####.
##..#....###.#.
#######.....##.
##..#####..#...
##..#####..#...
#######.....##.
##..#....###.#.
....##.#.#####.
#...##.#.#..##.
.#.####..#.####
...#.#.#.#.#..#
#####...##..#..
#####...##..#..

..#......#..#....
.###.##.###..#..#
.##..##..##..####
##.##..##.##.####
#.##.##.##.##.##.
.##.####.##......
#..#.##.#..#.####
..###..###.......
..##.##.##...#..#
.#..#..#..#.#.##.
#..#####...#..##.
##.######.###.##.
.#.##..##.#...##.
##........##.#..#
.##.#..#.##.##..#

..#.########.#.
...#.######.#..
##.#.#....#.#.#
##....####....#
..#######.####.
###.#......#.##
##..#..##..#..#

.#.##..
.##.###
##.##..
##.....
..#####
..#.###
###.#..
.#.#...
....#..
#..#.##
#....##
..#.###
..#.###
#.#..##
#..#.##
....#..
.#.#..."""

data_test_1 = """#.##..##.
..#.##.#.
##......#
##......#
..#.##.#.
..##..##.
#.#.##.#.

#...##..#
#....#..#
..##..###
#####.##.
#####.##.
..##..###
#....#..#
"""

data_test_2 = """..#......#...
###.####.####
.#..#..#.##..
.#..#..#..#..
##..####..###
##..####..###
.....##......
.###.##.###..
##..####..###
#.########.##
.##......##..
.#..#..#..#..
#...####...##"""

data_test_3 = """..####..##..##..#
...#..##.####.##.
.##.#.##..##..##.
...#..##.####.##.
.##..#..#....#..#
##.##.##########.
#########.##.####"""

data_test_4 = """###.##.##
##.####.#
##.#..#.#
####..###
....##...
##.#..#.#
...#..#..
##..###.#
##......#
##......#
..#.##.#.
...#..#..
##.####.#
....##...
...####..
....##...
##.####.#

.##.##...##...##.
#####..##..##..##
.....##..##..##..
.##.#.#.####.#.#.
.##...#.#..#.#...
....#..........#.
#..#..#......#..#
....###.....####.
.##...#.#..#.#...
.....#..####..#..
#..#...##..##...#
....#...#..#...#.
#..#.##########.#
#..##...####...##
#####.##.##.##.##"""

data_test_5 = """#.##..##.
..#.##.#.
##......#
##......#
..#.##.#.
..##..##.
#.#.##.#.

#...##..#
#....#..#
..##..###
#####.##.
#####.##.
..##..###
#....#..#

.#.##.#.#
.##..##..
.#.##.#..
#......##
#......##
.#.##.#..
.##..##.#

#..#....#
###..##..
.##.#####
.##.#####
###..##..
#..#....#
#..##...#

#.##..##.
..#.##.#.
##..#...#
##...#..#
..#.##.#.
..##..##.
#.#.##.#."""

time_start = time()

lines = data.splitlines()

data = []
tmp = []
for line in lines:
    if line != "":
        tmp.append([c for c in line])
    else:
        data.append(tmp)
        tmp = []
data.append(tmp)

def transpose(pattern):
    new_pattern = []
    for i in range(len(pattern[0])):
        tmp = []
        for j in range(len(pattern)):
            tmp.append(pattern[j][i])
        new_pattern.append(tmp)
        
    return new_pattern


def check_one_diference(i, j):
    sum_caracters = 0
    for ci, cj in zip(i, j):
        if ci == cj:
            sum_caracters += 1

    return sum_caracters == len(i) - 1


def create_new_pattern(pattern):
    new_pattern = []
    for idx, i in enumerate(pattern[:-1]):
        for jdx, j in enumerate(pattern[idx + 1:]):
            sum_caracters = 0
            pos = None
            for cidx, (ci, cj) in enumerate(zip(i, j)):
                if ci == cj:
                    sum_caracters += 1
                else:
                    pos = cidx
            if sum_caracters == len(i) - 1:
                new_pattern.append(deepcopy(pattern))
                new_pattern[-1][idx][pos] = '.' if new_pattern[-1][idx][pos] == '#' else '#'

    return new_pattern


def check_equal_lines(patterns, exclude_pos):
    pos = None
    for pattern in patterns:
        size = len(pattern)
        for idx, (i, j) in enumerate(zip(pattern, pattern[1:])):
            if i == j and idx != exclude_pos:
                pos = idx
                for k in range(1, size // 2 + 1):
                    if pos - k < 0 or pos + k + 1 > size - 1:
                        return pos, True
                    if pattern[pos - k] != pattern[pos + k + 1]:
                        break

    return pos, False


def check_equal_lines_part1(pattern):
    pos = None
    size = len(pattern)
    for idx, (i, j) in enumerate(zip(pattern, pattern[1:])):
        if i == j:
            pos = idx
            for k in range(1, size // 2 + 1):
                if pos - k < 0 or pos + k + 1 > size - 1:
                    return pos, True
                if pattern[pos - k] != pattern[pos + k + 1]:
                    break

    return pos, False


def check_equal_columns(pattern, exclude_pos):
    pattern = transpose(pattern)
    new_patterns = create_new_pattern(pattern)

    return check_equal_lines(new_patterns, exclude_pos)


def check_equal_columns_part1(pattern):
    pattern = transpose(pattern)

    return check_equal_lines_part1(pattern)


result = 0
for idx, pattern in enumerate(data):
    pos_columns_part1, equal_columns_part1 = check_equal_columns_part1(pattern)
    pos_columns_part1 = pos_columns_part1 if equal_columns_part1 else None
    pos_columns, equal_columns = check_equal_columns(pattern, pos_columns_part1)
    pos_lines_part1, equal_lines_part1 = check_equal_lines_part1(pattern)
    pos_lines_part1 = pos_lines_part1 if equal_lines_part1 else None
    new_patterns = create_new_pattern(pattern)
    pos_lines, equal_lines = check_equal_lines(new_patterns, pos_lines_part1)
    if equal_lines and pos_lines != -1:
        result += (pos_lines + 1) * 100
    if equal_columns and pos_columns != -1:
        result += pos_columns + 1

print('day 13 part 2:', result)
print(f'time elapsed: {(time() - time_start)}')
